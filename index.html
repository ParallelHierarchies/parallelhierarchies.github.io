<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11, IE=edge"/>
    <title>Parallel Hierarchies</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  </head>
  <body>
    <header>
      <!-- <div style="width:10%;">
        <img src="logo.png" style="width:100%"/>
      </div> -->
      <div id='title'>
        <h1>Parallel Hierarchies</h1>
        <p>A visualization for cross-tabulating hierarchical aggregates</p>
      </div>
      <div>
        <a class="button" href="./demo/index.html">demo</a>
      </div>
      <div id='links'>
        <ul>
          <li>
            <a href="https://github.com/ParallelHierarchies/ParallelHierarchies">
              <img alt="github logo" class="icon" src="./github-logo.png" />
            </a>
          </li>
          <li>
            <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fparallelhierarchies.github.io&amp;text=Check%20out%20Parallel%20Hierarchies%2C%20a%20visualization%20for%20cross-tabulating%20hierarchical%20aggregates." target="_blank" rel="noopener noreferrer" aria-label="Share on Twitter">
              <img alt="twitter logo" class="icon" src="./twitter-logo.png" />
            </a>
          </li>
          <li>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fparallelhierarchies.github.io%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">
              <img alt="facebook logo" class="icon" src="./facebook-logo.png" />
            </a>
          </li>
        </ul>
      </div>
    </header>

    <nav class="">
      <div id="content">
        <ul>
          <li><a onclick="focusSection(event)" class='features focus' href="#features">Features</a></li>
          <li><a onclick="focusSection(event)" class='tutorial' href="#tutorial">Tutorial</a></li>
          <li><a onclick="focusSection(event)" class='dataimport' href="#dataimport">Data Import</a></li>
          <li><a onclick="focusSection(event)" class='documentation' href="#documentation">Documentation</a></li>
          <li><a onclick="focusSection(event)" class='dataschema' href="#dataschema">Schema</a></li>
        </ul>
      </div>
    </nav>

    <article>
      <section class="focus" id="features">
        <h1>Features</h1>
        <h2>Quick Introduction</h2>
        <div style="margin-top: 30px;padding:61.16% 0 0 0;position:relative;">
          <iframe src="https://player.vimeo.com/video/279480161?title=0&byline=0&portrait=0" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
        </div>
        <script src="https://player.vimeo.com/api/player.js"></script>

        <h2>Stable Release</h2>
        <p>Includes all features as proposed in our paper and as listed above.</p>
        <p><a class="button" href="./demo/index.html">live demo</a></p>

        <h2 style="margin-top: 35px">Experimental Features</h2>
        <p>Expanding the functionality of <i>Parallel Hierarchies</i> with new features like multiple hierarchy selection per dimenion, an accordion mode to change width of categories and more animations between interactions.</p>
        <p><strong>Note: </strong>Does not allow minimization of ribbon intersections (yet).</p>

        <p><a class="button experimental" href="./demo/experimental.html">Experimental</a></p>
      </section>

      <section id="tutorial">
        <h1>Tutorial</h1>
        <h2>Getting Started</h2>
        <p>To follow this tutorial, you can either use <a href="./demo/index.html">the live demo</a>, or use a local version cloned from <a href="https://github.com/ParallelHierarchies/ParallelHierarchies">our GitHub repository</a>.</p>
        <p>When launching the visualization, you will be presented with a list of datsasets to choose from. To follow this tutorial, click-on "Yeast Gene Ontology".</p>
        <img width=400 alt="screenshot of the dataset picker. You can see a list of three options: 'Yeast Gene Ontology', '1990 Census (sample of 10k)' and '199 Census (sample of 100k)'" src="./img/choose_dataset.PNG"/>

        <p>After selecting the dataset, the view will be generated from the data. A toolbar is positioned on top and the actual visualization below. You can interact with both the toolbar and the visualization, but we will come to that later on.</p>

        <h2>The View Components</h2>
        <p>Below you can see a screenshot from the visualization after selecting the Yeast Gene Ontology dataset. Let's have a look at the components of the visualization and how they are called:</p>
        <img alt="screenshot of the Parallel Hierarchies visualization. Bezier paths of various widths connect two disjoint groups of rectangles that are stacked on top of each other, each on one side of the screen. Above some widgets." src="./img/overview.PNG" />

        <ol type="a">
          <li>title of the dataset</li>
          <li>dropdown menu to add new dimensions</li>
          <li>add a horizontal guideline for vertical height analysis</li>
          <li><a href="#cursor_interaction">switch cursor interaction</a></li>
          <li><a href="#ribbon_minimization">configure ribbon minimization</a></li>
          <li>pick a dataset</li>
          <li>reset the visualization to default values</li>
          <li><a href="#column_chart">Column chart</a></li>
          <li><a href="#dimension">a dimension</a></li>
          <li><a href="#ribbon">a ribbon between two neighboring dimensions</a></li>
        </ol>

        <h2>Adding/Removing Dimensions</h2>
        <p>
          You can now investigate the dataset.
          The first thing you might want to do is adding a new dimension to the visualization.
          To do so, click on the dropdown menu on the top of the screen that says "add dimension..." and select "Locus".
          An instance of the "Locus" dimension will now appear on the right side of the visualziation.
        </p>
        <p>
          You can now see the interconnections between three facets of the dataset as well as the individual values of each dimension.
          Move your mouse over any category to get more insights.
          Four things happen:
          <ol>
            <li>A tooltip appears that gives you detailed information on the highlighted category.</li>
            <li>All categories sharing at least one of the items represented by the highlighted category will be rendered darker than others.</li>
            <li>All ribbons that do not share any of the items will fade out.</li>
            <li>All ribbons that do share items will indicate the percentage by a darker ribbon on top.</li>
          </ol>
          The same thing will happen if you move your mouse over any ribbon.
        </p>
        <p>
          Now, add the dimension called "Strand". Whoops, we do not actually need that one, so let us delete it from the view.
          To do so, click the cross next to the name "Strand" in the header of the dimension.
        </p>

        <h2>Rearranging Dimensions</h2>
        <p>
          We now want to exlpore how the Locus chromosomes of the Locus dimension are interconnected to both Cellular Components and Biological Processes.
          In order to do this, we need to rearrange the dimensions and put the Locus dimension in between the other two.
          Drag the "Locus" name to the left, until the Biological Process dimension switches its position and drop it in place.
        </p>
        <p>
          You can now explore the cross-tabulation between Locus to it's neighboring dimensions.
        </p>

        <h2>Drilling down and Rolling up hierarchical categories</h2>
        <p>
          You may have noticed the <i>+</i> symbols on some of the categories.
          These indicate hierarchies in the dataset.
          This is <i>Parallel Hierarchies</i> after all, so let's find out more about those hierarchies, shall we?
          Click on the rectangle of the "cell part" category of the "Cellular Component" dimension.
        </p>
        <p>
          The visualization changes. Notice how the cell part category is now much bigger than before.
          It's name is rendered sideways on top of the rectangle. New categories appeared to the right of that category.
          We call this the <i>drill-down</i> operation.
          Now, let's drill-down further into the hierarchy of the cell part category by clicking "intracellular part" and then "cytoplasmic part".
          Notice how on each level, a new ancestor category appears slightly smaller than it's parent.
        </p>
        <p>
          Notice also that we can not drill-down further into this category. We have reached a dead end.
          In order to get back to higher levels of hierarchy, click on any of the ancestor categories to make them the working category.
          We call this the <i>roll-up</i> operation.
          Roll-up the cellular part hierarchy to reach the root by clicking on the "cellular part" ancestor category.
        </p>
        <p>
          Let us investigate the Locus dimension a bit more.
          Drill-down into the Locus dimension by clicking on any of the chromosome categories.
          Look at all those genes that are now visible. That's too many to work with, so let's reduce their numbers.
          Drill-down into "localization" > "establishment of localization" > "transport" on the Biological Process dimension on the right.
          Notice how on every level, the number of visible Genes reduces, because categories which do not share any items active on all other dimensions have a height of 0.
        </p>

        <h2>Category Interaction</h2>
        <p>
          You will notice how some categories in the Locus dimension do not have a label.
          The reason for this is that <i>Parallel Hierarchies</i> tries to keep the view as clean as possible by hiding labels of categories that are smaller than the labels themselves.
          We could use the tooltip to have a look at each category individually, but that is tiresome.
          Instead, let's switch our interaction mode from "Dragging" to "Fisheye" in the toolbar
        </p>
        <p>
          Now, if you move your mouse closer to the gene categories, their labels will appear.
          Also, Categories in a certain radius will be moved away to give more space to the ones in focus.
        </p>

        <br />

        <p>
          You are now familiar with the most important features of <i>Parallel Hierarchies</i>.
          But what do the other buttons do?
          Try it out for yourself or watch our in-depth video below.
        </p>

        <h2>In-Depth Video Tutorial</h2>
        <div style="margin-top: 30px;padding:61.16% 0 0 0;position:relative;">
          <iframe src="https://player.vimeo.com/video/281947411?title=0&byline=0&portrait=0" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
        </div>
        <script src="https://player.vimeo.com/api/player.js"></script>
      </section>

      <section id="dataimport">
        <h1>Use your own data</h1>
        <h2>Import into experimental version</h2>
        <p>
          The quickest way to use your own data is to use the experimental version data import feature.
          First, visit the <a href="https://parallelhierarchies.github.io/demo/experimental.html">website</a> and click the "Use your own Dataset" option.
        </p>
        <ol>
          <li>
            Click the "Choose File" button and pick the CSV file from your disk (make sure the data in your CSV file meets <a href="#datastructure_notice">the requirements</a>).
          </li>
          <li>
            In the "Aggregate Dimension" field, enter the exact name of the dimension that contains numerical values, which will be aggregated and represented by ribbon and category heights.
          </li>
          <li>
            <p>
              The last step is to define the hierarchies in your data one-by-one.
              In the "Label" field, choose any string that will be the name of the hierarchical dimension.
              Assuming your data is structured according to the requirements, enter the exact names of the dimensions making up a hierarchy, seperating each level by a comma.
            </p>
            <p>For example, if your hierarchy is "country" > "state" > "region" > "city" > "street", enter "country, state, region, city, street".</p>
          </li>
          <li>Afterwards, click the "add" button to store the hierarchy.</li>
          <li>When you have stored all hierarchies in the list, click the "Start" button to launch the application with your own dataset.</li>
        </ol>
        <img src="./img/custom_dataset.PNG" />

        <h2>Using your own schema</h2>
        <p>
          This assumes you have a CSV file with your items and a JSON file containting you schema in accordance with <a href="#datastructure_notice">the requirements</a> and a local clone of the github project ready to go.
        </p>
        <ol>
          <li>In the project directory, open src/app.js in a text editor or IDE.</li>
          <li>In the <code>CONFIGURATIONS</code> object, create a new property of type object with any name you like. This name will be used in the dropdown list when launching the application.</li>
          <li>
            <p>Assign the <code>schemaURI</code> and <code>itemsURI</code> properties to it, so that your entry looks something like this:</p>
            <ul class='code'>
              <li>'myCustomDataset': {</li>
              <li>
                <ul>
                  <li>schemaURI: './link/to/schema.json',</li>
                  <li>itemsURI: './link/to/items.csv'</li>
                </ul>
              </li>
              <li>}</li>
            </ul>
          </li>
          <li>
            <p>In the "index.html" file, add a new line right after line 59 that looks similar to this one: </p>
            <ul class='code'>
              <li>&lt;li&gt;</li>
              <li>
                <ul>
                  <li>&lt;button class="preset" value="myCustomDataset"&gt;</li>
                  <li>
                    <ul>
                      <li>&lt;i class="material-icons"&gt;folder_open&lt;/i&gt;</li>
                      <li>My Custom Dataset</li>
                    </ul>
                  </li>
                  <li>&lt;/button&gt;</li>
                </ul>
              </li>
              <li>&lt;/li&gt;</li>
            </ul>
          </li>
          <li>Launch the application and visit <a href="http://localhost:8080">localhost:8080</a>.</li>
          <li>Choose your own dataset from the list.</li>
        </ol>
        <img src="./img/custom_schema.PNG" />
      </section>

      <section id="documentation">
        <h1>Documentation</h1>
        <h2 id="dimension">Dimension</h2>
        <p><i>Represents a single facet of the dataset.</i></p>
        <img src="img/dimension.PNG" width=500 alt="Screenshot of a dimension in parallel hierarchies. The dimension is named 'Biological Process' and has the following visible categories: 'metabolic proc...', 'cellular process', 'localization', 'undefined', and 'biological reug...'. The 'undefined' category is highlighted." />
        <p>
          The top part of a dimension consists of a header component.
          Here you will see the name of the dimension, which has the same color as the categories further down.
          On the right side of the name, you will see an 'X' marker, which you can click to delete the dimension from the view.
        </p>
        <p>
          Placed below the name is the current ordering of the dimension. This can take one of three values:
          "Minimized Intersections" (order according to the minimization strategy), "Value" (sorted by aggregate value) and "Description" (sorted by names of categories).
          Click on the current ordering to select another strategy.
        </p>
        <p>
          The body is each dimension consists of the categories found in the data.
          A category is a single value that a set of items my contain for the individual dimension.
          Each dimension is assigned a specific color to quickly seperate them from each other.
          Both the dimension name and the categories have this particular color.
          You can find more information on the categories below.
        </p>
        <p>
          You can rearrange dimensions horizontally by dragging the name of the dimension to the left or right.
          Dimensions switch places if you move them at least half-way closer to each other.
        </p>

        <h2 id="category">Category</h2>
        <p><i>Represents a (hierarchical) value of a facet of the dataset.</i></p>
        <img src="./img/category.PNG" width=500 alt="Screenshot of a category in parallel hierarchies. It is labelled 'organelle' and has ribbons going out of it.'"/>
        <p>
          A category is a single value that a set of items my contain for the individual dimension.
          It is represented as a rectangle of fixed width.
          The height of each category represents the total sum of values of items that have the specific value.
          The bigger the height, the bigger the sum of values.
          If a category has a certain height, a label with its name will be placed on either the left or right side of the category.
          You can get detailed information on a category via the tooltip on mouse-over.
        </p>
        <p>
          A category may be hierarchical, which means that we can drill down into its subcategories.
          These subcategories are derived from the items in the CSV file and the hierarchies from the schema.
          Whether or not a category is hierarchical is indicated by a small <i>+</i> Symbol the at the upper end of the category.
          You can click a category to drill into its hierarchy
        </p>
        <p>
          Hierarchies in a category are represented by a simplified icicle tree that grows to the left and right side of a dimension.
          Only the path to the current level is shown in proportion.
          All other categories on lower levels are only indicated as small rectangles above and below an active ancestor.
          You can click an ancestor to roll up the hierarchy to its level.
          You can also click on inactive ancestors to make them the working category.
        </p>


        <h2 id="ribbon">Ribbon</h2>
        <p><i>Visualizes interconnections between two categories of two neighboring dimensions.</i></p>
        <img src="./img/ribbons.PNG" alt="Screenshot of ribbons in parallel hierarchies."/>
        <p>
          A ribbon displays the interconnection between categories of neighboring dimensions.
          It is represented as a horizontal bezier path.
          The start and end of this path are the connected categories.
          The height of this path represents the total sum of values of items that share both the source and target categories in their specific dimensions.
          You can get detailed information on a ribbon via the tooltip on mouse-over.
        </p>
        <p>
          If you mouse-over either a ribbon or a category, the set of items represented by the visual element will be highlighted.
          All categories sharing at least one of the items in that set will get a darker color.
          If a ribbon does not share any of the items in that set, it will be rendered more transparent.
          For ribbons that do share at least one of the items, a second path will show the percentage of the highlighted items to the overall items of the ribbon.
          This secondary ribbon is of darker color and aligned at the bottom of the primary ribbon, similar to stacked bar charts.
        </p>


        <h2 id="cursor_interaction">Cursor interaction</h2>
        <p><i>Interaction technique for categories.</i></p>
        <img src="./img/cursor_interaction.PNG" alt="Screenshot of a widget giving the option between 'fisheye' and 'dragging'" />
        <p>You can choose between two interactions modes when pointing the cursor on a category: The drag interaction, which lets you rearrange categories vertically, and the <a href="https://infovis-wiki.net/wiki/Fisheye_View">fisheye view</a> mode.</p>
        <p>
          If you activate the latter, you will notice that the spacing between categories increases in a certain radius, allowing more space between categories closest to the cursor.
          Also, labels for all categories will be displayed, regardless of their size.
          This is especially helpful when working with a large set of small categories, since labels can be read without the tooltip.
        </p>

        <h2 id="ribbon_minimization">Ribbon minimization</h2>
        <p><i>Optional minimization of ribbon intersections to reduce clutter.</i></p>
        <img src="./img/minimization_configuration.PNG" alt="Screenshot of a widget giving the option between 'Optimize Intersections' and 'Use Greedy'" />
        <p>
          To enable minimization, click the "Minmize intersections" option.
          This will toggle the use of the <a href="https://ieeexplore.ieee.org/document/4308636/">barycentric method</a> to calculate a new category ordering that minimizes ribbon intersections.
          A maximum of 10 iterations will be run.
        </p>
        <p>
          To further improve the minimization result, you can also click the "Use Greedy" option.
          The Greedy optimization will use the result of the barycentric method and an additional minimization step that reorders categories greedily.
          Notice that this will not always yield any changes of the visualization, since the greedy approach is not guaranteed to find better orderings.
        </p>

        <h2 id="column_chart">Column chart</h2>
        <p><i>Displays the amount of data filtered by the hierarchy queries on each dimension.</i></p>
        <img src="./img/column_chart.PNG" alt="Screenshot of a column chart showing six bars with various heights. All bars have unique colors. Above the bars are the values '2%', '53%', '23%', '100%', '90%' and '11%''" />
        <p>
          Drilling down a category in <i>Parallel Hierarchies</i> formulates a query on the containing dimension:
          "Find all categories in dimension A that are children of the hierarchy a1 > a2 > ...".
          For each individual dimension, one of these queries can be formulated.
          The column chart visualizes the effect that each individual query has on the overall amount of data that is visisble.
        </p>
        <p>
          The grey bar on the very left shows how many items of the dataset are currently visible (or filtered, depending on the mode selected in the dropdown menu above).
          Each colored bar right to that one represents the queries per dimension.
          The order the bars is the same as the order of dimensions in the visualization.
        </p>
      </section>

      <section id="dataschema">
        <h1 id="datastructure_notice">Data Schema</h1>
        <h2>CSV file</h2>
        <p>Let's assume, you want to represent the following hierarchical dimension in <i>Parallel Hierarchies</i>:</p>
        <img src="./img/hierarchy_example.PNG"/>
        <p>This is an easy task to do in JSON, since we can place objects inside other objects, creating a tree structure. In CSV files on the other hand, we need to flatten the hierarchy.</p>
        <p>
          The first thing we need to do is find the longest path in our hierarchy.
          In our example, it's the path
        </p>
        <p>
          <code>"Dimension A" > "Category A4" > "Category A4.1" > "Categry A4.1.1" or "Category A4.1.2"</code>
        </p>
        <p>
          We then need to get the length of that path, excluding the root, which in our case means it is 3.
          So for every item, instead of just storing the value for <code>Dimension A</code>, we need to store the path along the hierarchy to this category as seperate fields in the data.
          We also need to make sure to store deeper levels as empty.
        </p>

        <h3>Example</h3>
        <p>
          If an item in our data looked like this:
          <ul class='code'>
            <li>{</li>
            <li>
              <ul>
                <li>"dimension A": "category A4.1.2",</li>
                <li>"value": 100</li>
              </ul>
            </li>
            <li>}</li>
          </ul>
          We need to convert it to the following:
          <ul class='code'>
            <li>{</li>
            <li>
              <ul>
                <li>"dimensionA_Level0": "category A4",</li>
                <li>"dimensionA_Level1": "category A4.1",</li>
                <li>"dimensionA_Level2": "category A4.1.2",</li>
                <li>"value": 100</li>
              </ul>
            </li>
            <li>}</li>
          </ul>
        </p>
        <p>
          Respectively, the item
          <ul class='code'>
            <li>{</li>
            <li>
              <ul>
                <li>"dimension A": "category A1.2",</li>
                <li>"value": 40</li>
              </ul>
            </li>
            <li>}</li>
          </ul>
          has to be converted into
          <ul class='code'>
            <li>{</li>
            <li>
              <ul>
                <li>"dimensionA_Level0": "category A1",</li>
                <li>"dimensionA_Level1": "category A1.2",</li>
                <li>"dimensionA_Level2": "",</li>
                <li>"value": 40</li>
              </ul>
            </li>
            <li>}</li>
          </ul>
        </p>
        <p>
          Therefore, our CSV file containing those two items in the end would look like this:
        </p>
        <ul class='code'>
          <li>dimensionA_Level0,dimensionA_Level1,dimensionA_Level2,value</li>
          <li>category A4,category A4.1,category A4.1.2,100</li>
          <li>category A1,category A1.2,,40</li>
        </ul>

        <h2>JSON file</h2>
        <p>
          In addition to that we need to tell <i>Parallel Hierarchies</i> how the levels of our hierarchical dimensions are named, as well as some other metadata.
          We do this in a seperate JSON file with the following structure:
        </p>
        <ul class='code'>
          <li>{</li>
          <li>
            <ul>
              <li>"title": {string}, // name of our dataset </li>
              <li>"unit": {string}, // name of the unit our data ($, km, kg, people,...) </li>
              <li>"timestamps": {Array of strings}, // list of dimensions with quantitative data</li>
              <li><br/></li>
              <li>
                "hierarchies": [
              </li>
              <li>
                <ul>
                  <li>{ // one object per hierarchy</li>
                  <li>
                    <ul>
                      <li>"label": {string}, // name for our hierarchical data</li>
                      <li>"levels": {Array of strings} // ordered list of dimension levels</li>
                    </ul>
                  </li>
                  <li>}</li>
                </ul>
              </li>
              <li>]</li>
            </ul>
          </li>
          <li>}</li>
        </ul>

        <h3>Example</h3>
        <p>
          Following our example from the CSV file above, we would need to create a file looking like this:
        </p>
        <ul class='code'>
          <li>{</li>
          <li>
            <ul>
              <li>"title": "Example Dataset", </li>
              <li>"unit": "meters", </li>
              <li>"timestamps": ["value"],</li>
              <li><br/></li>
              <li>
                "hierarchies": [
              </li>
              <li>
                <ul>
                  <li>{</li>
                  <li>
                    <ul>
                      <li>"label": "Hierarchy A",</li>
                      <li>"levels": ["dimensionA_Level0", "dimensionA_Level1", "dimensionA_Level2"]</li>
                    </ul>
                  </li>
                  <li>}</li>
                </ul>
              </li>
              <li>]</li>
            </ul>
          </li>
          <li>}</li>
        </ul>

        <p>Both the CSV and the JSON file are then passed to an instace of <code>ParallelHierarchies</code> (example in the <code>src/app.js</code>)</p>
      </section>
    </article>

    <footer>
      <ul>
        <li>
          <a href="https://github.com/ParallelHierarchies/ParallelHierarchies">
              <img alt="github logo" class="icon" src="./github-logo.png" />Source Code available on GitHub
          </a>
        </li>
        <li>
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fparallelhierarchies.github.io&amp;text=Check%20out%20Parallel%20Hierarchies%2C%20a%20visualization%20for%20cross-tabulating%20hierarchical%20aggregates." target="_blank" rel="noopener noreferrer" aria-label="Share on Twitter">
            <img alt="twitter logo" class="icon" src="./twitter-logo.png" />Share on Twitter
          </a>
        </li>
        <li>
          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fparallelhierarchies.github.io%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">
            <img alt="facebook logo" class="icon" src="./facebook-logo.png" />Share on Facebook
          </a>
        </li>
      </ul>
    </footer>

    <script>
      var focusedSection = document.querySelector('#features');

      window.onload = function(event) {
        focusedSection = document.querySelector(window.location.hash);
        // focusSection({ target: focusedSection, event });
      };

      var focusSection = function(event) {
        document.querySelector('nav a.focus').classList.toggle('focus', false);
        event.target.classList.toggle('focus', true);

        var referencedSection = document.querySelector('#' + event.target.classList[0]);
        event.preventDefault();
        focusedSection.classList.toggle('focus', false);
        focusedSection = referencedSection;

        focusedSection.classList.toggle('focus', true);
      }

      // FIXME: navigation bar updates focused section
      // document.addEventListener('scroll', () => {
      //   var navBar = document.querySelector('nav');
      //   // navBar.classList.toggle('hidden', window.scrollY < 100);

      //   var sections = document.querySelectorAll('section');
      //   sections.forEach(function(section) {
      //     var top = section.getBoundingClientRect().top;
      //     var bottom = section.getBoundingClientRect().bottom;
      //     var className = section.id.split('').splice(0).join('');
      //     var navAnchor = document.querySelector('.' + className);

      //     navAnchor.classList.toggle('focus', top < 150 && bottom > 150);
      //   });
      // });
    </script>
  </body>
</html>
